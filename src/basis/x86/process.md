# 进程

进程有时被称为任务，有时我们又称之为程序。

“尽管表面上看起来程序和进程非常类似，但本质上它们确是截然不同的。程序是指一个静态的指令序列，而进程则是一个容器，其中包含了当执行一个程序的特定实例时所用到的各种资源。”

进程就是各种资源的集合，通常一个进程包含下面几种资源：

- 私有的线性地址空间。
- 可执行的程序：包括代码与数据。
- 一些已经获得的其他资源，如打开的文件、管道等。
- 进程的权限
- 进程的描述符

## 上下文

上下文包括进程、中断的上下文，上下文的概念是从 CPU 角度引出的。简单的说，上下文就是程序（进程/中断）运行时所需要的寄存器的最小集合，这些寄存器的后面可能代表着程序运行的一类资源，例如 CR3 寄存器就可以概括进程的私有线性地址空间（分页机制启动时）。

- x86 上下文包含的寄存器

    通用寄存器组，段相关寄存器组，标志寄存器，程序指针寄存器，GDT 基地址，LDT 段选择符，IDT 基地址，控制寄存器组，浮点相关寄存器组以及一些特殊用途的寄存器。

从程序员的观点来看，上下文的概念有些微改变，通常对于上下文切换时不需要改变的寄存器，也可以说它不是该程序的上下文。

## 上下文切换

上下文切换是指程序从一种状态切换到另一种状态（例如用户态切换到内核态），或从一个程序切换到另一个程序（例如进程切换），导致上下文相关寄存器值得变化行为。通常会触发上下文切换的三种情况：

- 用户态到内核态的切换：此时的上下文的切换时因为进程的用户态和内核态运行在不同的 Ring 级别，对资源的访问权限不同，需要切换部分上下文。

- 进程切换：由于一个 CPU 在同一时刻只能有一个进程运行，所以在新的进程运行前，需要把上下文相关的寄存器的值替换成新的进程的相关值，这通常是全文切换。

- 遇到中断上下文切换：中断的处理函数运行在特殊的上下文环境，称为中断上下文。

## 参考资料

Linux Processes：http://www.tldp.org/LDP/tlk/kernel/processes.html
