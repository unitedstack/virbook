### CPU 地址空间

- 物理地址空间

我们一般将安插在主板上的物理内存比喻成一个大数组，地址就是这个数组索引。从 CPU 的角度来看，内存和其他硬件设备都是可使用资源，这些资源组合在一起，分布在 CPU 的物理地址空间中，CPU 使用物理地址索引这些资源。

- 线性地址空间

一个物理平台只有一个地址空间，但每个程序都是认为自己独享整个平台的硬件资源，为了让更多的程序有效、隔离地使用物理地址空间资源于是出现了线性地址空间的概念。线性地址空间被映射到物理地址空间的一部分或整个物理地址空间。

### 地址

根据访问地址空间的不同，索引可以分为线性地址、物理地址，由于x86 引入特殊的段机制，因此还有一种地址：逻辑地址。

三者的关系如下：

- 分段机制启用，分页未启用：逻辑地址 -> 线性地址 = 物理地址
- 分段、分页机制同时启用：逻辑地址 -> 线性地址 -> 物理地址


### x86 内存管理机制

- 分段机制

分段地址是一种朴素的内存管机制，它将内存划分成以起始地址 (Base)和长度 (Limit)描述的块，这些内存就被成为“段”。分段机制由 4 个基本部分构成：逻辑地址、段选择寄存器、段描述符和段描述符表。

- 分页机制

分页是更加细力度化的内存管理机制，与分段机制将内存划分成以基地址和长度描述的多个段进行管理不同，分页机制使用粒度化的单位“页”来管理线性地址空间和物理地址空间。分页机制的核心思想是通过页表的将线性地址转换为物理地址。

- TLB (Translation Lookaside Buffer)

### 参考文档

地址空间：https://github.com/chyyuu/ucore_os_docs/blob/master/lab1/lab1_3_2_2_address_space.md

内存分段：https://en.wikipedia.org/wiki/X86_memory_segmentation

内存分页：http://wiki.osdev.org/Paging

Memory Management：http://www.tldp.org/LDP/tlk/mm/memory.html

